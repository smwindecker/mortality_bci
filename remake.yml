packages:
  - rstan
  - dplyr
  - RCurl
  - downloader
  - rmarkdown

sources:
  - R

include:
  # This file is automatically generated and is quite large.  It defines
  # targets for each model

targets:
  all:
    depends:
      - ms.md

  BCI_training_test:
    depends:
      - BCI_training_full
      - BCI_training_test_1
      - BCI_training_test_2
      - BCI_training_test_3
      - BCI_training_test_4
      - BCI_training_test_5
      - BCI_training_test_6
      - BCI_training_test_7
      - BCI_training_test_8
      - BCI_training_test_9
      - BCI_training_test_10

  BCI_training_full:
    command: extract_traintest_set(BCI_model_dataset_folds, NA)
    cleanup_level: purge

  BCI_training_test_1:
    command: extract_traintest_set(BCI_model_dataset_folds, 1)
    cleanup_level: purge

  BCI_training_test_2:
    command: extract_traintest_set(BCI_model_dataset_folds, 2)
    cleanup_level: purge

  BCI_training_test_3:
    command: extract_traintest_set(BCI_model_dataset_folds, 3)
    cleanup_level: purge

  BCI_training_test_4:
    command: extract_traintest_set(BCI_model_dataset_folds, 4)
    cleanup_level: purge

  BCI_training_test_5:
    command: extract_traintest_set(BCI_model_dataset_folds, 5)
    cleanup_level: purge

  BCI_training_test_6:
    command: extract_traintest_set(BCI_model_dataset_folds, 6)
    cleanup_level: purge

  BCI_training_test_7:
    command: extract_traintest_set(BCI_model_dataset_folds, 7)
    cleanup_level: purge

  BCI_training_test_8:
    command: extract_traintest_set(BCI_model_dataset_folds, 8)
    cleanup_level: purge

  BCI_training_test_9:
    command: extract_traintest_set(BCI_model_dataset_folds, 9)
    cleanup_level: purge

  BCI_training_test_10:
    command: extract_traintest_set(BCI_model_dataset_folds, 10)
    cleanup_level: purge

  BCI_model_dataset_folds:
    command: split_into_kfolds(BCI_model_dataset_unique)
    cleanup_level: purge

  BCI_model_dataset_unique:
    command: reduce_to_single_ind_obs(BCI_model_dataset_full)
    cleanup_level: purge

  BCI_model_dataset_full:
    command: merge_BCI_data(BCI_demography, BCI_traits)
    cleanup_level: purge

  BCI_demography:
    command: BCI_calculate_individual_growth(BCI_50haplot, BCI_nomenclature)
    cleanup_level: purge

  BCI_traits:
    command: load_trait_data("data/BCI_traits_20101220.csv")
    cleanup_level: purge

  BCI_50haplot:
    command: BCI_load_50ha_plot("downloads/bci.full.Rdata31Aug2012.zip")
    cleanup_level: purge

  downloads/bci.full.Rdata31Aug2012.zip:
    command: BCI_download_50ha_plot_full(target_name)
    cleanup_level: never
    check: exists

  BCI_nomenclature:
    command: BCI_load_nomenclature("downloads/bci.spptable.rdata")

  downloads/bci.spptable.rdata:
    command: BCI_download_species_table(target_name)
    cleanup_level: never
    check: exists

  # paper
  downloads/style.csl:
    command: get_amnat_csl(target_name)

  ms.pdf:
    command: pandoc_build("ms.md")

  ms.md:
    knitr: true
    depends:
      - data/refs.bib
      - downloads/style.csl
