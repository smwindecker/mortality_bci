# Manually list these so that we can install them with the main batch
# of packages.
r_packages:
  - RcppEigen
  - inline

commands:
  rstan:
    # neither on cran nor github and a pain to install
    #
    # At the moment, (https://github.com/stan-dev/rstan/issues/163) we
    # can't use the current BH verison on CRAN.  Not sure when this
    # will be reflected by a new release, but once that happens,
    # remove the BH downgrade.
    command: |
      RUN \
        r -e 'devtools::install_version("BH", version="1.55.0-3")' && \
        MAKEVARS="-j1" install2.r --error
        --repos=http://cran.rstudio.com
        --repos=http://rstan.org/repo
        rstan
    after: r_packages
  upgrade_install2.r:
    # allow multiple repos in the rstan installation instructions:
    command: |
      RUN rm /usr/local/bin/install2.r &&
        wget --no-check-certificate
        https://raw.githubusercontent.com/cboettig/littler/master/examples/install2.r
        -O /usr/local/bin/install2.r
        && chmod +x /usr/local/bin/install2.r
    after: apt_packages
